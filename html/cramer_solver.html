<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cramer Exam — 3×3 System</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.js"></script>


  <style>
    body {
      font-family: Arial;
      padding: 18px;
      max-width: 1100px;
      margin: auto
    }

    h2 {
      margin-top: 6px
    }

    .matrix-container {
      display: inline-block;
      padding: 8px;
      border-left: 3px solid #111;
      border-right: 3px solid #111;
      margin: 8px
    }

    .matrix-row {
      display: flex
    }

    .matrix-input {
      width: 56px;
      text-align: center;
      margin: 4px
    }

    .term {
      display: flex;
      align-items: center;
      margin: 6px 0
    }

    .minor {
      margin-left: 10px
    }

    .sign-btn {
      width: 44px
    }

    .section {
      border: 1px solid #ddd;
      padding: 12px;
      border-radius: 8px;
      margin: 12px 0;
      background: #fbfbfb
    }

    label {
      font-weight: 600
    }

    .eq {
      margin: 6px 0
    }

    .small {
      font-size: 0.9em;
      color: #444
    }

    button {
      cursor: pointer
    }

    .bracketsvg {
      height: 100%;
      vertical-align: middle
    }

    .controls {
      display: flex;
      gap: 8px;
      flex-wrap: wrap
    }
  </style>
</head>

<body>
  <h2>Cramer’s Rule Exam — 3×3 (interactive)</h2>
  <p class="small">Paste a 3×4 augmented matrix as JSON (e.g. [[1,2,3,4],[4,5,6,7],[7,8,9,10]]). The last column are
    constants.</p>

  <div class="section">
    <label>Augmented matrix (3×4)</label>
    <input id="augInput" type="text" placeholder='[[1,2,3,4],[4,5,6,7],[7,8,9,10]]' style="width:420px">
    <div class="controls">
      <button onclick="loadAug()">Load</button>
      <button onclick="loadRandom()">Random</button>
      <button onclick="resetAll()">Reset</button>
    </div>
    <div id="system" class="eq"></div>
  </div>

  <!-- Section |A| Cofactors by columns -->
  <div id="secA" class="section">
    <h3>|A| — Cofactors by columns</h3>
    <div id="A_area"></div>
    <div id="A_terms"></div>
    <!--div class="controls">
      <button onclick="checkSectionA()">Check syntax</button>
      <span id="A_check" class="small"></span>
    </div-->

    <div class="final-section">
      <label for="finalExpr0">Write your final expression: </label>
      <input type="text" id="finalExpr0" style="width:400px;">
      <button onclick="checkExpression(0)">Check</button>
      <div id="checkResult0"></div>
    </div>

  </div>

  <!-- Section |A1| Cofactors by rows -->
  <div id="secA1" class="section">
    <h3>|A1| — Replace column 1 by constants; expand by rows</h3>
    <div id="A1_area"></div>
    <div id="A1_terms"></div>
    <!--div class="controls">
      <button onclick="checkSectionA1()">Check syntax</button>
      <span id="A1_check" class="small"></span>
    </div-->

    <div class="final-section">
      <label for="finalExpr1">Write your final expression: </label>
      <input type="text" id="finalExpr1" style="width:400px;">
      <button onclick="checkExpression(1)">Check</button>
      <div id="checkResult1"></div>
    </div>
  </div>

  <!-- Section |A2| Sarrus -->
  <div id="secA2" class="section">
    <h3>|A2| — Sarrus</h3>
    <div id="A2_area"></div>


    <div class="final-section">
      <label for="finalExpr2">Write your final expression: </label>
      <input type="text" id="finalExpr2" style="width:400px;">
      <button onclick="checkExpression(2)">Check</button>
      <div id="checkResult2"></div>
    </div>
  </div>

  <!-- Section |A3| Gaussian elimination -->
  <div id="secA3" class="section">
    <h3>|A3| — Gaussian elimination (triangular)</h3>
    <div id="gauss_area"></div>
    <div style="margin-top:8px">
      <input id="operation" placeholder="e.g. R2-2R1->R2 or R1<->R3" style="width:260px">
      <button onclick="handleOperation()">Apply</button>
      <!--button onclick="recordA3()">Record |A3| from current triangular</button-->
    </div>
    <div class="small">Applied operations:</div>
    <div id="appliedOps" class="small"></div>
    <!-- <div class="controls">
      <button onclick="checkSectionA3()">Check syntax</button>
      <span id="A3_check" class="small"></span>
    </div> -->
    <div class="final-section">
      <label for="finalExpr3">Write your final expression: </label>
      <input type="text" id="finalExpr3" style="width:400px;">
      <button onclick="checkExpression(3)">Check</button>
      <div id="checkResult3"></div>
    </div>
  </div>

  <!-- Final answers and send -->
  <div class="section">
    <h3>Final answers (student enters their computed determinants and solution)</h3>
    <div>
      <label>|A|</label> <input id="studentA" class="matrix-input">
      <label>|A1|</label> <input id="studentA1" class="matrix-input">
      <label>|A2|</label> <input id="studentA2" class="matrix-input">
      <label>|A3|</label> <input id="studentA3" class="matrix-input">
    </div>
    <div style="margin-top:8px">
      <label>Solutions (x,y,z)</label>
      <input id="solx" class="matrix-input"> <input id="soly" class="matrix-input"> <input id="solz"
        class="matrix-input">
    </div>
    <!-- <div class="controls" style="margin-top:10px">
      <button onclick="finalCheckSyntax()">Check final syntax</button>
      <button onclick="enviarOperaciones()">Send (submit)</button>
      <span id="final_check" class="small"></span>
    </div> -->
    <div>
      <input type="text" id="nombre" placeholder="Nombre">
      <input type="text" id="codigo" placeholder="Código">
      <button id="enviarOperaciones1" onclick="enviarOperaciones()">Enviar Operaciones</button>
    </div>
  </div>

  <script>
    // ---- Utilities ----
    //function determinant2(a, b, c, d) { return a * d - b * c; }
    //function determinant3(m) {
    //  return round4(m[0][0] * (m[1][1] * m[2][2] - m[1][2] * m[2][1]) - m[0][1] * (m[1][0] * m[2][2] - m[1][2] * m[2][0]) + m[0][2] * (m[1][0] * m[2][1] - m[1][1] * m[2][0]));
    //}
    function round4(v) { return Math.round((v + 0) * 10000) / 10000; }

    let aug = []; // 3x4 input
    let A = []; // 3x3 coeff matrix
    let constants = [];
    let expansionA = []; // objects per term for |A|
    let expansionA1 = []; // for |A1|
    let matrixGame = null; // for gaussian
    //let recordedA3 = null; // value recorded by teacher or student via recordA3

    // ---- Load / display ----
    function loadAug() {
      const txt = document.getElementById('augInput').value.trim();
      try { const parsed = JSON.parse(txt); if (!Array.isArray(parsed) || parsed.length !== 3 || parsed.some(r => r.length !== 4)) throw 'bad'; aug = parsed; }
      catch (e) { alert('Invalid input. Provide JSON 3x4. Generating random.'); loadRandom(); return; }
      processAug();
    }
    function loadRandom() {
      aug = Array.from({ length: 3 }, () => Array.from({ length: 4 }, () => Math.floor(Math.random() * 7) - 3));
      document.getElementById('augInput').value = JSON.stringify(aug);
      processAug();
    }
    function resetAll() { aug = []; A = []; constants = []; expansionA = []; expansionA1 = []; matrixGame = null; document.getElementById('system').innerHTML = ''; document.getElementById('A_area').innerHTML = ''; document.getElementById('A_terms').innerHTML = ''; document.getElementById('A1_area').innerHTML = ''; document.getElementById('A1_terms').innerHTML = ''; document.getElementById('A2_area').innerHTML = ''; document.getElementById('gauss_area').innerHTML = ''; document.getElementById('appliedOps').innerHTML = ''; }

    function processAug() {
      A = aug.map(r => r.slice(0, 3).map(x => +x));
      constants = aug.map(r => +r[3]);
      showSystem();
      buildA();
      buildA1();
      buildA2();
      initGauss();
    }

    function showSystem() {
      const d = document.getElementById('system'); d.innerHTML = '';
      for (let i = 0; i < 3; i++) {
        const a = A[i]; const b = constants[i];
        d.innerHTML += `<div>${a[0]}x + ${a[1]}y + ${a[2]}z = ${b}</div>`;
      }
    }

    // ---- Build coefficient matrix A and |A| expansion by columns ----
    function buildA() {
      const area = document.getElementById('A_area'); area.innerHTML = '';
      const wrapper = document.createElement('div'); wrapper.className = 'matrix-container';
      for (let i = 0; i < 3; i++) { const row = document.createElement('div'); row.className = 'matrix-row'; for (let j = 0; j < 3; j++) { const inp = document.createElement('input'); inp.className = 'matrix-input'; inp.type = 'number'; inp.value = A[i][j]; row.appendChild(inp); } wrapper.appendChild(row); } area.appendChild(wrapper);

      // create 3 column expansion terms (empty inputs initially)
      const termsDiv = document.getElementById('A_terms'); termsDiv.innerHTML = ''; expansionA = [];
      for (let col = 0; col < 3; col++) {
        const term = document.createElement('div'); term.className = 'term';
        const signBtn = document.createElement('button'); signBtn.className = 'sign-btn'; signBtn.textContent = '+'; signBtn.onclick = () => signBtn.textContent = (signBtn.textContent === '+') ? '-' : '+'; term.appendChild(signBtn);
        const coeff = document.createElement('input'); coeff.type = 'number'; coeff.className = 'matrix-input'; coeff.value = ''; term.appendChild(coeff);
        const minorDiv = document.createElement('div'); minorDiv.className = 'matrix-container minor'; const minors = [];
        for (let i = 0; i < 2; i++) { const r = document.createElement('div'); r.className = 'matrix-row'; for (let j = 0; j < 2; j++) { const mi = document.createElement('input'); mi.className = 'matrix-input'; mi.type = 'number'; mi.value = ''; r.appendChild(mi); minors.push(mi); } minorDiv.appendChild(r); } term.appendChild(minorDiv); termsDiv.appendChild(term); expansionA.push({ signBtn, coeff, minors });
      }
    }

    // ---- Build A1: replace col1 with constants and expand by rows ----
    function buildA1() {
      const area = document.getElementById('A1_area'); area.innerHTML = '';
      const wrapper = document.createElement('div'); wrapper.className = 'matrix-container';
      for (let i = 0; i < 3; i++) { const row = document.createElement('div'); row.className = 'matrix-row'; for (let j = 0; j < 3; j++) { const inp = document.createElement('input'); inp.className = 'matrix-input'; inp.type = 'number'; inp.value = (A[i][j]); inp.disabled = false; row.appendChild(inp); } wrapper.appendChild(row); } area.appendChild(wrapper);

      const termsDiv = document.getElementById('A1_terms'); termsDiv.innerHTML = ''; expansionA1 = [];
      // expand by rows: 3 rows
      for (let r = 0; r < 3; r++) {
        const term = document.createElement('div'); term.className = 'term';
        const signBtn = document.createElement('button'); signBtn.className = 'sign-btn'; signBtn.textContent = '+'; signBtn.onclick = () => signBtn.textContent = (signBtn.textContent === '+') ? '-' : '+'; term.appendChild(signBtn);
        const coeff = document.createElement('input'); coeff.type = 'number'; coeff.className = 'matrix-input'; coeff.value = ''; term.appendChild(coeff);
        const minorDiv = document.createElement('div'); minorDiv.className = 'matrix-container minor'; const minors = [];
        for (let i = 0; i < 2; i++) { const rowD = document.createElement('div'); rowD.className = 'matrix-row'; for (let j = 0; j < 2; j++) { const mi = document.createElement('input'); mi.className = 'matrix-input'; mi.type = 'number'; mi.value = ''; rowD.appendChild(mi); minors.push(mi); } minorDiv.appendChild(rowD); } term.appendChild(minorDiv); termsDiv.appendChild(term); expansionA1.push({ signBtn, coeff, minors });
      }
    }

    // ---- Build A2 (Sarrus) display ----
    function buildA2() { const area = document.getElementById('A2_area'); area.innerHTML = ''; const wrapper = document.createElement('div'); wrapper.className = 'matrix-container'; for (let i = 0; i < 3; i++) { const row = document.createElement('div'); row.className = 'matrix-row'; for (let j = 0; j < 3; j++) { const inp = document.createElement('input'); inp.className = 'matrix-input'; inp.type = 'number'; inp.value = A[i][j]; inp.disabled = false; row.appendChild(inp); } wrapper.appendChild(row); } area.appendChild(wrapper); }

    // ---- Gaussian part using MatrixGame ----
    class MatrixGame {
      constructor(matrix) { this.matrix = matrix.map(r => r.slice()); } parseOperation(opStr) { opStr = opStr.toLowerCase().replace(/\s+/g, ''); let swapMatch = opStr.match(/r(\d+)<->r(\d+)/); let scaleMatch = opStr.match(/(-?\d*\.?\d*)r(\d+)->r(\d+)/); let addMatch = opStr.match(/(-?\d*\.?\d*)r(\d+)([-+]\d*\.?\d*)r(\d+)->r(\d+)/); if (swapMatch) return { type: 'swap', row1: parseInt(swapMatch[1]) - 1, row2: parseInt(swapMatch[2]) - 1 }; else if (addMatch) { if (addMatch[1] === '-') addMatch[1] = '-1'; if (addMatch[3] === '-') addMatch[3] = '-1'; return { type: 'add', scalar1: parseFloat(addMatch[1]) || 1, row1: parseInt(addMatch[2]) - 1, scalar2: parseFloat(addMatch[3]) || 1, row2: parseInt(addMatch[4]) - 1, targetRow: parseInt(addMatch[5]) - 1 }; } else if (scaleMatch) { if (scaleMatch[1] === '-') scaleMatch[1] = '-1'; return { type: 'scale', scalar: parseFloat(scaleMatch[1]) || 1, row: parseInt(scaleMatch[2]) - 1 }; } else throw new Error('Operación no válida'); }
      applyOperation(opStr) { let op = this.parseOperation(opStr); let newM = this.matrix.map(r => r.slice()); if (op.type === 'swap') { [newM[op.row1], newM[op.row2]] = [newM[op.row2], newM[op.row1]]; } else if (op.type === 'scale') { newM[op.row] = newM[op.row].map(v => round4(v * op.scalar)); } else if (op.type === 'add') { for (let i = 0; i < newM[0].length; i++) { newM[op.targetRow][i] = round4(op.scalar1 * newM[op.row1][i] + op.scalar2 * newM[op.row2][i]); } } return newM; }
    }

    function initGauss() { const area = document.getElementById('gauss_area'); area.innerHTML = ''; const wrapper = document.createElement('div'); wrapper.className = 'matrix-container'; for (let i = 0; i < 3; i++) { const row = document.createElement('div'); row.className = 'matrix-row'; for (let j = 0; j < 3; j++) { const inp = document.createElement('input'); inp.className = 'matrix-input'; inp.type = 'number'; inp.value = aug[i][j]; inp.disabled = false; row.appendChild(inp); } wrapper.appendChild(row); } area.appendChild(wrapper); matrixGame = new MatrixGame(aug.map(r => r.slice())); document.getElementById('appliedOps').innerHTML = ''}

    function handleOperation() {
      const op = document.getElementById('operation').value.trim(); try {
        const newM = matrixGame.applyOperation(op); matrixGame.matrix = newM; // update display
        const area = document.getElementById('gauss_area'); area.innerHTML = ''; const wrapper = document.createElement('div'); wrapper.className = 'matrix-container'; for (let i = 0; i < 3; i++) { const row = document.createElement('div'); row.className = 'matrix-row'; for (let j = 0; j < 3; j++) { const inp = document.createElement('input'); inp.className = 'matrix-input'; inp.type = 'number'; inp.value = matrixGame.matrix[i][j]; inp.disabled = false; row.appendChild(inp); } wrapper.appendChild(row); } area.appendChild(wrapper);
        document.getElementById('appliedOps').innerHTML += op + '<br>';
      } catch (e) { alert(e.message); }
    }

    //function recordA3() { // assume matrixGame.matrix is triangular (or will compute product of diagonal of coefficient 3x3 submatrix)
    //  const m = matrixGame.matrix.map(r => r.slice(0, 3)); let prod = 1; for (let i = 0; i < 3; i++) prod *= m[i][i]; recordedA3 = round4(prod); alert('|A3| recorded as ' + recordedA3);
    //}

    // ---- Syntax checks (students can run these, but won't see grading) ----
    function checkSectionA() {
      const chk = document.getElementById('A_check'); try { // check that coeffs and minors are numeric
        let ok = true; expansionA.forEach((t, idx) => { const c = t.coeff.value; if (c === '') ok = false; t.minors.forEach(mi => { if (mi.value === '') ok = false; }); }); chk.textContent = ok ? 'Syntax OK' : 'Syntax Error: fill numbers';
      } catch (e) { chk.textContent = 'Error'; }
    }
    function checkSectionA1() { const chk = document.getElementById('A1_check'); try { let ok = true; expansionA1.forEach(t => { if (t.coeff.value === '') ok = false; t.minors.forEach(mi => { if (mi.value === '') ok = false; }); }); chk.textContent = ok ? 'Syntax OK' : 'Syntax Error: fill numbers'; } catch (e) { chk.textContent = 'Error'; } }
    function checkSectionA2() { const chk = document.getElementById('A2_check'); try { let ok = true; for (let i = 0; i < 3; i++) { if (document.getElementById('s_down_' + i).value === '') ok = false; if (document.getElementById('s_up_' + i).value === '') ok = false; } chk.textContent = ok ? 'Syntax OK' : 'Syntax Error: fill diagonal products'; } catch (e) { chk.textContent = 'Error'; } }
    function checkSectionA3() {
      const chk = document.getElementById('A3_check'); try { // verify applied operations have valid syntax
        chk.textContent = document.getElementById('appliedOps').innerText.trim() ? 'Syntax OK' : 'Syntax OK (no ops yet)';
      } catch (e) { chk.textContent = 'Error'; }
    }
    function finalCheckSyntax() { const chk = document.getElementById('final_check'); try { const sA = document.getElementById('studentA').value; const sA1 = document.getElementById('studentA1').value; const sA2 = document.getElementById('studentA2').value; const sA3 = document.getElementById('studentA3').value; if ([sA, sA1, sA2, sA3].some(v => v === '')) chk.textContent = 'Syntax Error: fill final determinants'; else chk.textContent = 'Syntax OK'; } catch (e) { chk.textContent = 'Error'; } }

    function checkExpression(num) {
      const expr = document.getElementById('finalExpr' + num).value;
      const result = document.getElementById('checkResult' + num);

      try {
        // only allow digits, +, -, *, /, parentheses, spaces, and decimal point
        if (/^[0-9+\-*/(). ]+$/.test(expr)) {
          ev = math.evaluate(expr); // safe parser, no eval
          result.textContent = "✅ Expression valid: " + ev;
        } else {
          throw new Error("Invalid characters");
        }
      } catch (e) {
        result.textContent = "❌ Syntax error: " + e.message;
      }
    }





    // ---- Compute student-submitted determinant values from section inputs ----
    function computeFromExpansion(expansion, byColumn = true) { // sum sign * coeff * det(minor)
      let total = 0; for (let k = 0; k < expansion.length; k++) { const t = expansion[k]; const sign = t.signBtn.textContent === '+' ? 1 : -1; const coeff = parseFloat(t.coeff.value); const minors = t.minors.map(m => parseFloat(m.value)); if (Number.isNaN(coeff) || minors.some(x => Number.isNaN(x))) return null; const det2 = determinant2(minors[0], minors[1], minors[2], minors[3]); total += sign * coeff * det2; } return round4(total);
    }

    function computeStudentA() { return computeFromExpansion(expansionA, true); }
    function computeStudentA1() { return computeFromExpansion(expansionA1, false); }
    function computeStudentA2() { // compute from Sarrus inputs
      let down = 0; let up = 0; for (let i = 0; i < 3; i++) { const dv = parseFloat(document.getElementById('s_down_' + i).value); const uv = parseFloat(document.getElementById('s_up_' + i).value); if (Number.isNaN(dv) || Number.isNaN(uv)) return null; down += dv; up += uv; } return round4(down - up);
    }
    function computeStudentA3() { const v = parseFloat(document.getElementById('studentA3').value); if (!Number.isFinite(v)) return null; return round4(v); }

    // ---- Final grading (hidden from student) ----
    function gradeAll() {
      const correctA = determinant3(A); // true |A|
      // build A1: replace col 0 with constants
      const A1 = A.map((r, i) => [constants[i], r[1], r[2]]); const correctA1 = determinant3(A1);
      const correctA2 = determinant3(A);
      // compute correctA3 by gaussian to triangular (we can compute det by determinant3 as well) -- but requirement was via gauss; use det(A) as ground truth
      const correctA3 = determinant3(A);

      const sA = computeStudentA(); const sA1 = computeStudentA1(); const sA2 = computeStudentA2(); const sA3 = computeStudentA3();
      let score = 0; let total = 4; if (sA !== null && sA === correctA) score++; if (sA1 !== null && sA1 === correctA1) score++; if (sA2 !== null && sA2 === correctA2) score++; if (sA3 !== null && sA3 === correctA3) score++;
      return { score, total, details: { correct: { A: correctA, A1: correctA1, A2: correctA2, A3: correctA3 }, student: { A: sA, A1: sA1, A2: sA2, A3: sA3 } } };
    }

    // ---- Build textual steps string for form submission ----
    function buildStepsForForm() {
      const parts = [];
      // A terms
      expansionA.forEach(t => { const s = t.signBtn.textContent; const c = t.coeff.value || ''; const v = t.minors.map(m => m.value || ''); parts.push(`${s}(${c})*det(${v.join(',')})`); });
      // A1 terms
      expansionA1.forEach(t => { const s = t.signBtn.textContent; const c = t.coeff.value || ''; const v = t.minors.map(m => m.value || ''); parts.push(`${s}(${c})*det(${v.join(',')})`); });
      // Sarrus
      //const sdown = [0,1,2].map(i=>document.getElementById('s_down_'+i).value||'').join(',');
      //const sup = [0,1,2].map(i=>document.getElementById('s_up_'+i).value||'').join(',');
      //parts.push(`Sarrus_down:${sdown}`); parts.push(`Sarrus_up:${sup}`);
      // Gauss ops
      parts.push('Gauss_ops:' + document.getElementById('appliedOps').innerText.replace(/\n/g, ';'));
      return parts.join(';');
    }

    // ---- Submit to Google Form (includes hidden grade) ----
    function enviarOperaciones() {
      //if (operacionesAplicadas.length === 0) {
      //    alert("No hay operaciones para enviar.");
      //    return;
      //}
      let nombreInput = document.getElementById("nombre");
      let codigoInput = document.getElementById("codigo");
      //const operacionesTexto = checkresult.innerHTML;

      const formURL = "https://docs.google.com/forms/d/e/1FAIpQLSdq-y90C6FZTOq10fkWvoz9spigyQ9R1z6r1nc-5Vm_DqVDdA/formResponse";
      const formData = new FormData();

      // Replace this entry ID with the correct field for operations in your Google Form
      formData.append("entry.155816829", "Cramer");
      formData.append("entry.516472959", nombreInput.value);
      formData.append("entry.519404034", codigoInput.value);
      formData.append("entry.1237481299", finalExpr0.value + ";"+finalExpr1.value + ";"+finalExpr2.value + ";"+finalExpr3.value+" ; "+buildStepsForForm()+";"+ document.getElementById('studentA').value+";"+ document.getElementById('studentA1').value+";"+ document.getElementById('studentA2').value+";"+ document.getElementById('studentA3').value+";"+ document.getElementById('solx').value + ',' + document.getElementById('soly').value + ',' + document.getElementById('solz').value );
      //console.log("buildStepsForForm"+":"+buildStepsForForm());// getElementById(finalExpr3)
      fetch(formURL, {
        method: "POST",
        mode: "no-cors",
        body: formData
      }).then(() => {
        alert("Operaciones enviadas con éxito.");
      }).catch(error => {
        console.error("Error al enviar operaciones:", error);
      });
    }


    function enviarOperaciones1() {
      const name = document.getElementById('nombre').value || ''; const code = document.getElementById('codigo').value || ''; const finalExpr = document.getElementById('solx').value + ',' + document.getElementById('soly').value + ',' + document.getElementById('solz').value; const stepsText = buildStepsForForm(); const grading = gradeAll(); const formURL = 'https://docs.google.com/forms/d/e/1FAIpQLSdq-y90C6FZTOq10fkWvoz9spigyQ9R1z6r1nc-5Vm_DqVDdA/formResponse'; const formData = new FormData(); formData.append('entry.155816829', 'Cramer Exam'); formData.append('entry.516472959', name); formData.append('entry.519404034', code); // put steps, final solutions and grade
      const payload = `steps:${stepsText} || final:${finalExpr} || grade:${grading.score}/${grading.total} || details:${JSON.stringify(grading.details)}`;
      formData.append('entry.1237481299', payload);
      fetch(formURL, { method: 'POST', mode: 'no-cors', body: formData }).then(() => { alert('Submitted.'); }).catch(e => { console.error(e); alert('Submit failed'); });
    }

    // init with random example
    loadRandom();
  </script>
</body>

</html>